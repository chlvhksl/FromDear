(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[695],{5491:function(e,t,s){Promise.resolve().then(s.bind(s,8247))},8247:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var r=s(7437),n=s(2265),a=s(9376),i=s(2141),l=s(7648),d=s(5865);function o(e){let{params:t}=e,[s,a]=(0,n.useState)(null),[o,c]=(0,n.useState)([]),[x,m]=(0,n.useState)(!0),[h,u]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{let{data:e}=await i.O.from("users").select("*").eq("link_id",t.link_id).single();if(e){a(e);let{data:t,error:s}=await i.O.rpc("get_public_gifts",{target_user_id:e.id});t?c(t):s&&console.error("Error fetching gifts:",s)}m(!1)})()},[t.link_id]);let f=async e=>{u(e);let{data:t,error:s}=await i.O.from("messages").select("content, is_opened, emotion_analysis").eq("id",e.id).single();t&&t.content?(u(e=>({...e,content:t.content,emotion_analysis:t.emotion_analysis})),e.is_opened||(await i.O.from("messages").update({is_opened:!0}).eq("id",e.id),c(t=>t.map(t=>t.id===e.id?{...t,is_opened:!0}:t)))):u(e=>({...e,is_private:!0}))};return x?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-red-50",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})}):s?(0,r.jsxs)("main",{className:"min-h-screen relative bg-gradient-to-br from-red-50 via-white to-green-50 py-10 px-4 overflow-hidden",children:[(0,r.jsx)(d.Z,{}),(0,r.jsxs)("div",{className:"relative z-10 max-w-5xl mx-auto",children:[(0,r.jsxs)("div",{className:"text-center mb-12",children:[(0,r.jsx)("div",{className:"inline-block px-4 py-1 bg-white/80 backdrop-blur-sm rounded-full text-red-600 text-sm font-medium mb-4 shadow-sm border border-white",children:"FromDear ❄️ Happy Winter"}),(0,r.jsxs)("h1",{className:"text-4xl md:text-6xl font-black text-gray-900 mb-6 tracking-tight",children:[(0,r.jsx)("span",{className:"text-green-600",children:s.username}),"님의",(0,r.jsx)("br",{className:"md:hidden"})," 선물함 \uD83C\uDF81"]}),(0,r.jsx)("div",{className:"inline-flex items-center gap-2 bg-red-100 text-red-600 px-6 py-2 rounded-full font-bold text-lg mb-8 shadow-sm",children:(0,r.jsxs)("span",{children:["총 ",o.length,"개의 선물이 도착했어요!"]})}),(0,r.jsxs)("p",{className:"text-xl text-gray-600 mb-10 max-w-xl mx-auto font-medium",children:["따뜻한 마음이 배달왔어요.",(0,r.jsx)("br",{}),"도착한 선물들을 열어보세요!"]}),(0,r.jsx)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:(0,r.jsx)(l.default,{href:"/box/message?id=".concat(t.link_id),className:"inline-block px-10 py-4 bg-gradient-to-r from-red-600 to-green-600 text-white font-bold rounded-full shadow-xl hover:shadow-2xl hover:scale-105 transition-all duration-300 text-lg animate-pulse",children:"나도 선물 보내기 \uD83C\uDF81"})})]}),(0,r.jsx)("div",{className:"bg-white/40 backdrop-blur-md rounded-[2.5rem] p-6 md:p-12 shadow-2xl border border-white/60 min-h-[400px]",children:0===o.length?(0,r.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-center py-20",children:[(0,r.jsx)("div",{className:"text-6xl mb-6 opacity-50",children:"\uD83D\uDCED"}),(0,r.jsx)("h3",{className:"text-2xl font-bold text-gray-600 mb-2",children:"아직 도착한 선물이 없어요"}),(0,r.jsx)("p",{className:"text-gray-500",children:"가장 먼저 친구에게 마음을 선물해보세요!"})]}):(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6",children:o.map((e,t)=>(0,r.jsxs)("div",{onClick:()=>f(e),className:"aspect-square bg-white rounded-3xl p-4 md:p-6 shadow-lg relative overflow-hidden group cursor-pointer hover:-translate-y-2 hover:shadow-2xl transition-all duration-300 flex flex-col items-center justify-center",children:[(0,r.jsx)("span",{className:"text-6xl md:text-7xl mb-4 md:mb-5 transform group-hover:scale-110 transition-transform duration-300",children:e.is_opened?"\uD83E\uDDF8":"\uD83C\uDF81"}),(0,r.jsx)("span",{className:"text-sm md:text-base font-bold text-gray-500 bg-gray-100 px-3 py-1 rounded-full z-10 truncate max-w-[90%]",children:e.sender_name||"익명"}),!e.is_opened&&(0,r.jsx)("div",{className:"absolute top-4 right-4 w-3 h-3 bg-red-500 rounded-full animate-ping"})]},e.id))})}),(0,r.jsx)("div",{className:"mt-16 text-center",children:(0,r.jsx)(l.default,{href:"/",className:"text-gray-500 hover:text-red-600 font-bold border-b-2 border-transparent hover:border-red-600 transition-all text-lg",children:"나도 선물함 만들기 →"})})]}),h&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:()=>u(null),children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-lg p-8 shadow-2xl transform transition-all scale-100 relative",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{onClick:()=>u(null),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("div",{className:"text-4xl mb-4",children:"\uD83C\uDF81"}),(0,r.jsxs)("h3",{className:"text-2xl font-bold text-gray-900 text-balance break-keep",children:[h.sender_name||"익명","님이 보낸 선물"]}),(0,r.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:new Date(h.created_at).toLocaleDateString()})]}),h.emotion_analysis&&(0,r.jsxs)("div",{className:"mx-auto mb-6 bg-white border-2 border-dashed border-gray-300 p-4 rounded-lg w-full max-w-xs relative rotate-1 shadow-sm",children:[(0,r.jsx)("div",{className:"absolute -top-2 left-1/2 transform -translate-x-1/2 bg-white px-2 text-xs font-bold text-gray-400 tracking-widest",children:"INGREDIENTS"}),(0,r.jsx)("h4",{className:"text-center font-bold text-gray-700 mb-3 border-b pb-2 text-sm",children:"선물 성분표 \uD83E\uDDFE"}),(0,r.jsx)("div",{className:"space-y-2",children:Object.entries(h.emotion_analysis).map(e=>{let[t,s]=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,r.jsx)("span",{className:"font-medium text-gray-600",children:t}),(0,r.jsx)("div",{className:"flex-1 mx-3 h-2 bg-gray-100 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-red-400 rounded-full",style:{width:"".concat(s,"%")}})}),(0,r.jsxs)("span",{className:"font-mono font-bold text-gray-800",children:[s,"%"]})]},t)})}),(0,r.jsx)("div",{className:"mt-3 pt-2 border-t border-dashed border-gray-300 text-center text-xs text-gray-400 font-mono",children:"100% SINCERITY INCLUDED"})]}),h.is_private?(0,r.jsxs)("div",{className:"bg-gray-50 p-10 rounded-xl text-center mb-6",children:[(0,r.jsx)("div",{className:"text-4xl mb-3",children:"\uD83D\uDD12"}),(0,r.jsx)("h4",{className:"font-bold text-gray-800 mb-2",children:"비밀 선물이네요!"}),(0,r.jsxs)("p",{className:"text-gray-500 text-sm",children:["이 선물은 ",(0,r.jsx)("strong",{children:s.username}),"님 본인만",(0,r.jsx)("br",{}),"확인할 수 있어요."]})]}):(0,r.jsx)("div",{className:"bg-gray-50 p-6 rounded-xl text-gray-700 leading-relaxed whitespace-pre-wrap max-h-[60vh] overflow-y-auto mb-6",children:h.content||"내용을 불러오는 중..."}),(0,r.jsx)("button",{onClick:()=>u(null),className:"w-full py-3 bg-red-600 text-white font-bold rounded-xl hover:bg-red-700 transition-colors",children:"닫기"})]})})]}):(0,r.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-red-50 text-center px-4",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"사용자를 찾을 수 없어요 \uD83D\uDE22"}),(0,r.jsx)("p",{className:"text-gray-600 mb-8",children:"주소가 올바른지 확인해주세요."}),(0,r.jsx)(l.default,{href:"/",className:"px-8 py-3 bg-red-600 text-white rounded-full font-bold hover:bg-red-700 transition-colors shadow-lg",children:"홈으로 가기"})]})}function c(){let e=(0,a.useSearchParams)().get("id")||"";return e?(0,r.jsx)(o,{params:{link_id:e}}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"잘못된 접근입니다."})}function x(){return(0,r.jsx)(n.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"로딩 중..."}),children:(0,r.jsx)(c,{})})}},5865:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(7437),n=s(2265);function a(){let e=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let t=e.current;if(!t)return;let s=t.getContext("2d");if(!s)return;let r=window.innerWidth,n=window.innerHeight;t.width=r,t.height=n;let a=[];for(let e=0;e<50;e++)a.push({x:Math.random()*r,y:Math.random()*n,radius:3*Math.random()+1,speed:1*Math.random()+.5,opacity:.5*Math.random()+.3});!function e(){s&&t&&(s.clearRect(0,0,t.width,t.height),s.fillStyle="white",a.forEach(e=>{s.beginPath(),s.arc(e.x,e.y,e.radius,0,2*Math.PI),s.fillStyle="rgba(255, 255, 255, ".concat(e.opacity,")"),s.fill(),e.y+=e.speed,e.x+=.5*Math.sin(e.y/50),e.y>t.height&&(e.y=-10,e.x=Math.random()*t.width)}),requestAnimationFrame(e))}();let i=()=>{t&&(t.width=window.innerWidth,t.height=window.innerHeight)};return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),(0,r.jsx)("canvas",{ref:e,className:"fixed inset-0 pointer-events-none z-50",style:{width:"100%",height:"100%"}})}},2141:function(e,t,s){"use strict";s.d(t,{O:function(){return i}});var r=s(338);let n="https://vlydnlmwwhofsksikaeh.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZseWRubG13d2hvZnNrc2lrYWVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3ODQ0NzEsImV4cCI6MjA3ODM2MDQ3MX0.XA5pvZRRAVd5h3q1g4iJ0Muibadb1gIKbSBnuW9lu78";n&&a||console.warn("Supabase environment variables are not set");let i=(0,r.createBrowserClient)(n,a)},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[338,648,971,117,744],function(){return e(e.s=5491)}),_N_E=e.O()}]);